# è…¾è®¯äº‘æœåŠ¡å™¨å•ä½“éƒ¨ç½²æ•™ç¨‹

> å®Œæ•´çš„åç«¯ + å‰ç«¯å•æœåŠ¡å™¨éƒ¨ç½²æŒ‡å—ï¼ˆä½¿ç”¨ Neon æ•°æ®åº“ï¼‰

## ğŸ“‹ éƒ¨ç½²æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              è…¾è®¯äº‘ CVM (Ubuntu)                             â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  å‰ç«¯ (Next.js)                                       â”‚  â”‚
â”‚  â”‚  ç«¯å£: 3000                                           â”‚  â”‚
â”‚  â”‚  URL: http://æœåŠ¡å™¨IP:3000                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                          â†“                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  åç«¯ (FastAPI)                                       â”‚  â”‚
â”‚  â”‚  ç«¯å£: 8000                                           â”‚  â”‚
â”‚  â”‚  URL: http://æœåŠ¡å™¨IP:8000                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                          â†“                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   Neon PostgreSQL      â”‚
              â”‚   (äº‘ç«¯æ‰˜ç®¡æ•°æ®åº“)      â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ éƒ¨ç½²ä¿¡æ¯

- **ä»“åº“åœ°å€**: https://github.com/ameureka/ai-deepresearch-agent
- **æœåŠ¡å™¨**: è…¾è®¯äº‘ CVM Ubuntu (root ç”¨æˆ·)
- **æ•°æ®åº“**: Neon PostgreSQL (å·²é…ç½®)
- **éƒ¨ç½²æ–¹å¼**: å•ä½“éƒ¨ç½²ï¼ˆå‰ç«¯ + åç«¯åŒä¸€æœåŠ¡å™¨ï¼‰
- **ç«¯å£éœ€æ±‚**: 
  - 22 (SSH)
  - 3000 (å‰ç«¯)
  - 8000 (åç«¯)

---

## ğŸ“ å‡†å¤‡å·¥ä½œ

### 1. è…¾è®¯äº‘å®‰å…¨ç»„é…ç½®

ç™»å½•è…¾è®¯äº‘æ§åˆ¶å°ï¼Œä¸ºä½ çš„ CVM é…ç½®å®‰å…¨ç»„è§„åˆ™ï¼š

| åè®® | ç«¯å£ | æ¥æº | è¯´æ˜ |
|------|------|------|------|
| TCP | 22 | 0.0.0.0/0 | SSH ç™»å½• |
| TCP | 3000 | 0.0.0.0/0 | Next.js å‰ç«¯ |
| TCP | 8000 | 0.0.0.0/0 | FastAPI åç«¯ |

> âš ï¸ **ç”Ÿäº§ç¯å¢ƒå»ºè®®**ï¼š
> - é™åˆ¶ SSH (22) ç«¯å£ä»…å…è®¸ç‰¹å®š IP è®¿é—®
> - åç»­å¯ä»¥é…ç½® Nginx åå‘ä»£ç†ï¼Œåªå¼€æ”¾ 80/443 ç«¯å£

### 2. åˆ›å»ºéƒ¨ç½²ç”¨æˆ·ï¼ˆæ¨èï¼‰

è™½ç„¶ä½ å½“å‰ä½¿ç”¨ root ç”¨æˆ·ï¼Œä½†å»ºè®®åˆ›å»ºä¸“ç”¨éƒ¨ç½²ç”¨æˆ·ï¼š

```bash
# åˆ›å»ºéƒ¨ç½²ç”¨æˆ·
sudo useradd -m -s /bin/bash appuser

# è®¾ç½®å¯†ç 
sudo passwd appuser

# æ·»åŠ  sudo æƒé™ï¼ˆå¯é€‰ï¼‰
sudo usermod -aG sudo appuser

# åˆ‡æ¢åˆ°éƒ¨ç½²ç”¨æˆ·
sudo -iu appuser
```

> ğŸ’¡ **æç¤º**ï¼šå¦‚æœç»§ç»­ä½¿ç”¨ root ç”¨æˆ·éƒ¨ç½²ï¼Œè·³è¿‡æ­¤æ­¥éª¤å³å¯ã€‚

### 3. å‡†å¤‡ API å¯†é’¥

ç¡®ä¿ä½ å·²ç»è·å–ä»¥ä¸‹ API å¯†é’¥ï¼š

- âœ… **DeepSeek API Key**: https://platform.deepseek.com/
- âœ… **OpenAI API Key**: https://platform.openai.com/
- âœ… **Tavily API Key**: https://tavily.com/
- âœ… **Neon Database URL**: ä» Neon æ§åˆ¶å°è·å–è¿æ¥å­—ç¬¦ä¸²

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### æ­¥éª¤ 1: SSH ç™»å½•æœåŠ¡å™¨

```bash
ssh root@ä½ çš„æœåŠ¡å™¨IP
```

### æ­¥éª¤ 2: å®‰è£…ç³»ç»Ÿä¾èµ–

```bash
# æ›´æ–°ç³»ç»ŸåŒ…
sudo apt update && sudo apt upgrade -y

# å®‰è£…å¿…è¦çš„ä¾èµ–
sudo apt install -y \
    python3.11 \
    python3.11-venv \
    python3-pip \
    git \
    curl \
    build-essential \
    libpq-dev

# å®‰è£… Node.js 18+ (ä½¿ç”¨ NodeSource)
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt install -y nodejs

# éªŒè¯å®‰è£…
python3.11 --version  # åº”è¯¥æ˜¾ç¤º Python 3.11.x
node --version        # åº”è¯¥æ˜¾ç¤º v18.x æˆ–æ›´é«˜
npm --version         # åº”è¯¥æ˜¾ç¤º npm ç‰ˆæœ¬
```

### æ­¥éª¤ 3: å…‹éš†é¡¹ç›®ä»£ç 

```bash
# è¿›å…¥éƒ¨ç½²ç›®å½•
cd /opt

# å…‹éš†ä»“åº“
sudo git clone https://github.com/ameureka/ai-deepresearch-agent.git agentic-ai

# è®¾ç½®ç›®å½•æƒé™ï¼ˆå¦‚æœä½¿ç”¨ appuserï¼‰
sudo chown -R appuser:appuser /opt/agentic-ai

# è¿›å…¥é¡¹ç›®ç›®å½•
cd /opt/agentic-ai
```

### æ­¥éª¤ 4: é…ç½®åç«¯ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘ç¯å¢ƒå˜é‡
nano .env
```

**é…ç½® `.env` æ–‡ä»¶**ï¼ˆé‡è¦ï¼ï¼‰ï¼š

```bash
# ============================================================================
# API Keys
# ============================================================================
DEEPSEEK_API_KEY=sk-your-deepseek-key-here
OPENAI_API_KEY=sk-your-openai-key-here
TAVILY_API_KEY=tvly-your-tavily-key-here

# ============================================================================
# Database (Neon PostgreSQL)
# ============================================================================
DATABASE_URL=postgresql://user:password@ep-xxx.neon.tech/dbname?sslmode=require

# ============================================================================
# Server Configuration
# ============================================================================
HOST=0.0.0.0
PORT=8000
ENV=production
LOG_LEVEL=INFO

# ============================================================================
# CORS Configuration
# ============================================================================
# å…è®¸å‰ç«¯è®¿é—®ï¼ˆé‡è¦ï¼ï¼‰
ALLOWED_ORIGINS=http://ä½ çš„æœåŠ¡å™¨IP:3000,http://localhost:3000

# ============================================================================
# Uvicorn Workers
# ============================================================================
WORKERS=4

# ============================================================================
# Model Configuration
# ============================================================================
PLANNER_MODEL=deepseek:deepseek-reasoner
RESEARCHER_MODEL=deepseek:deepseek-chat
WRITER_MODEL=deepseek:deepseek-chat
EDITOR_MODEL=deepseek:deepseek-chat
FALLBACK_MODEL=openai:gpt-4o-mini

# ============================================================================
# Context Management
# ============================================================================
ENABLE_CHUNKING=true
CHUNKING_THRESHOLD=0.8
MAX_CHUNK_SIZE=6000
CHUNK_OVERLAP=200
```

> âš ï¸ **é‡è¦æç¤º**ï¼š
> - å°† `ä½ çš„æœåŠ¡å™¨IP` æ›¿æ¢ä¸ºå®é™…çš„è…¾è®¯äº‘æœåŠ¡å™¨å…¬ç½‘ IP
> - ç¡®ä¿ `DATABASE_URL` åŒ…å« `?sslmode=require` å‚æ•°
> - `ALLOWED_ORIGINS` å¿…é¡»åŒ…å«å‰ç«¯åœ°å€ï¼Œå¦åˆ™ä¼šå‡ºç° CORS é”™è¯¯

### æ­¥éª¤ 5: å®‰è£…åç«¯ä¾èµ–

```bash
# åˆ›å»º Python è™šæ‹Ÿç¯å¢ƒ
python3.11 -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source venv/bin/activate

# å‡çº§ pip
pip install --upgrade pip

# å®‰è£…é¡¹ç›®ä¾èµ–
pip install -r requirements.txt

# éªŒè¯å®‰è£…
python -c "import fastapi; import aisuite; print('Dependencies OK')"
```

### æ­¥éª¤ 6: æµ‹è¯•åç«¯æœåŠ¡

```bash
# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼ˆå¦‚æœæœªæ¿€æ´»ï¼‰
source venv/bin/activate

# å¯åŠ¨åç«¯æœåŠ¡ï¼ˆæµ‹è¯•æ¨¡å¼ï¼‰
uvicorn main:app --host 0.0.0.0 --port 8000

# åœ¨å¦ä¸€ä¸ªç»ˆç«¯æµ‹è¯•
curl http://localhost:8000/health
# åº”è¯¥è¿”å›: {"status":"healthy","version":"..."}
```

å¦‚æœæµ‹è¯•æˆåŠŸï¼ŒæŒ‰ `Ctrl+C` åœæ­¢æœåŠ¡ï¼Œç»§ç»­ä¸‹ä¸€æ­¥ã€‚

### æ­¥éª¤ 7: é…ç½®å‰ç«¯ç¯å¢ƒå˜é‡

```bash
# è¿›å…¥å‰ç«¯ç›®å½•
cd /opt/agentic-ai/ai-chatbot-main

# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.local.example .env.local

# ç¼–è¾‘ç¯å¢ƒå˜é‡
nano .env.local
```

**é…ç½® `.env.local` æ–‡ä»¶**ï¼š

```bash
# ============================================================================
# Database (ä¸åç«¯ä½¿ç”¨ç›¸åŒçš„ Neon è¿æ¥)
# ============================================================================
POSTGRES_URL=postgresql://user:password@ep-xxx.neon.tech/dbname?sslmode=require

# ============================================================================
# Backend API Configuration
# ============================================================================
# æœåŠ¡å™¨ç«¯è°ƒç”¨ï¼ˆNext.js æœåŠ¡å™¨ç»„ä»¶ï¼‰
RESEARCH_API_URL=http://localhost:8000

# å®¢æˆ·ç«¯è°ƒç”¨ï¼ˆæµè§ˆå™¨ï¼‰
NEXT_PUBLIC_API_URL=http://ä½ çš„æœåŠ¡å™¨IP:8000

# ============================================================================
# Authentication
# ============================================================================
# ç”Ÿæˆéšæœºå¯†é’¥: openssl rand -base64 32
AUTH_SECRET=your-random-secret-min-32-chars-here
AUTH_URL=http://ä½ çš„æœåŠ¡å™¨IP:3000/api/auth

# ============================================================================
# Node Environment
# ============================================================================
NODE_ENV=production

# ============================================================================
# Vercel Services (å¯é€‰ï¼Œå¦‚æœä¸ä½¿ç”¨å¯ä»¥æ³¨é‡Šæ‰)
# ============================================================================
# BLOB_READ_WRITE_TOKEN=vercel_blob_xxx
# AI_GATEWAY_API_KEY=vercel_ag_xxx
```

> âš ï¸ **é‡è¦æç¤º**ï¼š
> - `NEXT_PUBLIC_API_URL` å¿…é¡»ä½¿ç”¨æœåŠ¡å™¨å…¬ç½‘ IPï¼Œå› ä¸ºè¿™æ˜¯æµè§ˆå™¨è®¿é—®çš„åœ°å€
> - `AUTH_SECRET` å¿…é¡»æ˜¯è‡³å°‘ 32 å­—ç¬¦çš„éšæœºå­—ç¬¦ä¸²
> - ç”Ÿæˆ AUTH_SECRET: `openssl rand -base64 32`

### æ­¥éª¤ 8: å®‰è£…å‰ç«¯ä¾èµ–

```bash
# ç¡®ä¿åœ¨å‰ç«¯ç›®å½•
cd /opt/agentic-ai/ai-chatbot-main

# å®‰è£… pnpmï¼ˆæ¨èï¼‰
npm install -g pnpm

# å®‰è£…ä¾èµ–
pnpm install

# æˆ–è€…ä½¿ç”¨ npm
# npm install
```

### æ­¥éª¤ 9: æ„å»ºå‰ç«¯

```bash
# è¿è¡Œæ•°æ®åº“è¿ç§»
pnpm db:migrate

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
pnpm build

# éªŒè¯æ„å»º
ls -la .next/
```

### æ­¥éª¤ 10: æµ‹è¯•å‰ç«¯æœåŠ¡

```bash
# å¯åŠ¨å‰ç«¯æœåŠ¡ï¼ˆæµ‹è¯•æ¨¡å¼ï¼‰
pnpm start

# åœ¨æµè§ˆå™¨è®¿é—®
# http://ä½ çš„æœåŠ¡å™¨IP:3000
```

å¦‚æœèƒ½æ­£å¸¸è®¿é—®ï¼ŒæŒ‰ `Ctrl+C` åœæ­¢æœåŠ¡ï¼Œç»§ç»­é…ç½®æœåŠ¡å¸¸é©»ã€‚

---

## ğŸ”§ é…ç½®æœåŠ¡å¸¸é©»ï¼ˆSystemdï¼‰

### 1. åˆ›å»ºåç«¯æœåŠ¡

```bash
sudo nano /etc/systemd/system/agentic-backend.service
```

**å†™å…¥ä»¥ä¸‹å†…å®¹**ï¼š

```ini
[Unit]
Description=Agentic AI FastAPI Backend
After=network.target

[Service]
Type=simple
User=root
WorkingDirectory=/opt/agentic-ai
EnvironmentFile=/opt/agentic-ai/.env
ExecStart=/opt/agentic-ai/venv/bin/uvicorn main:app \
    --host 0.0.0.0 \
    --port 8000 \
    --workers 4 \
    --proxy-headers \
    --timeout-keep-alive 75 \
    --log-level info

Restart=always
RestartSec=10
KillSignal=SIGQUIT
TimeoutStopSec=20

StandardOutput=append:/opt/agentic-ai/logs/backend.log
StandardError=append:/opt/agentic-ai/logs/backend-error.log

[Install]
WantedBy=multi-user.target
```

> ğŸ’¡ **æç¤º**ï¼šå¦‚æœä½¿ç”¨ appuserï¼Œå°† `User=root` æ”¹ä¸º `User=appuser`

### 2. åˆ›å»ºå‰ç«¯æœåŠ¡

```bash
sudo nano /etc/systemd/system/agentic-frontend.service
```

**å†™å…¥ä»¥ä¸‹å†…å®¹**ï¼š

```ini
[Unit]
Description=Agentic AI Next.js Frontend
After=network.target agentic-backend.service
Requires=agentic-backend.service

[Service]
Type=simple
User=root
WorkingDirectory=/opt/agentic-ai/ai-chatbot-main
Environment="NODE_ENV=production"
Environment="PORT=3000"
ExecStart=/usr/bin/pnpm start

Restart=always
RestartSec=10
KillSignal=SIGTERM
TimeoutStopSec=20

StandardOutput=append:/opt/agentic-ai/logs/frontend.log
StandardError=append:/opt/agentic-ai/logs/frontend-error.log

[Install]
WantedBy=multi-user.target
```

### 3. åˆ›å»ºæ—¥å¿—ç›®å½•

```bash
# åˆ›å»ºæ—¥å¿—ç›®å½•
sudo mkdir -p /opt/agentic-ai/logs

# è®¾ç½®æƒé™
sudo chown -R root:root /opt/agentic-ai/logs
# å¦‚æœä½¿ç”¨ appuser: sudo chown -R appuser:appuser /opt/agentic-ai/logs
```

### 4. å¯åŠ¨æœåŠ¡

```bash
# é‡æ–°åŠ è½½ systemd é…ç½®
sudo systemctl daemon-reload

# å¯ç”¨å¹¶å¯åŠ¨åç«¯æœåŠ¡
sudo systemctl enable agentic-backend
sudo systemctl start agentic-backend

# æ£€æŸ¥åç«¯çŠ¶æ€
sudo systemctl status agentic-backend

# å¯ç”¨å¹¶å¯åŠ¨å‰ç«¯æœåŠ¡
sudo systemctl enable agentic-frontend
sudo systemctl start agentic-frontend

# æ£€æŸ¥å‰ç«¯çŠ¶æ€
sudo systemctl status agentic-frontend
```

### 5. æŸ¥çœ‹æ—¥å¿—

```bash
# æŸ¥çœ‹åç«¯æ—¥å¿—
sudo journalctl -u agentic-backend -f

# æŸ¥çœ‹å‰ç«¯æ—¥å¿—
sudo journalctl -u agentic-frontend -f

# æŸ¥çœ‹æ–‡ä»¶æ—¥å¿—
tail -f /opt/agentic-ai/logs/backend.log
tail -f /opt/agentic-ai/logs/frontend.log
```

---

## âœ… éªŒè¯éƒ¨ç½²

### 1. æ£€æŸ¥æœåŠ¡çŠ¶æ€

```bash
# æ£€æŸ¥åç«¯
curl http://localhost:8000/health
# åº”è¯¥è¿”å›: {"status":"healthy",...}

# æ£€æŸ¥å‰ç«¯
curl http://localhost:3000
# åº”è¯¥è¿”å› HTML å†…å®¹
```

### 2. æµè§ˆå™¨è®¿é—®

- **å‰ç«¯**: http://ä½ çš„æœåŠ¡å™¨IP:3000
- **åç«¯ API æ–‡æ¡£**: http://ä½ çš„æœåŠ¡å™¨IP:8000/docs
- **åç«¯å¥åº·æ£€æŸ¥**: http://ä½ çš„æœåŠ¡å™¨IP:8000/health

### 3. æµ‹è¯•ç ”ç©¶åŠŸèƒ½

1. æ‰“å¼€å‰ç«¯é¡µé¢
2. ç™»å½•æˆ–æ³¨å†Œè´¦å·
3. å‘é€æ¶ˆæ¯ï¼š"ç ”ç©¶ä¸€ä¸‹é‡å­è®¡ç®—"
4. ç‚¹å‡»"å¼€å§‹ç ”ç©¶"æŒ‰é’®
5. è§‚å¯Ÿå®æ—¶è¿›åº¦æ›´æ–°
6. æŸ¥çœ‹æœ€ç»ˆç ”ç©¶æŠ¥å‘Š

---

## ğŸ”„ æ—¥å¸¸è¿ç»´

### æ›´æ–°ä»£ç 

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /opt/agentic-ai

# æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# æ›´æ–°åç«¯ä¾èµ–
source venv/bin/activate
pip install -r requirements.txt

# æ›´æ–°å‰ç«¯ä¾èµ–
cd ai-chatbot-main
pnpm install
pnpm build

# é‡å¯æœåŠ¡
sudo systemctl restart agentic-backend
sudo systemctl restart agentic-frontend
```

### æŸ¥çœ‹æ—¥å¿—

```bash
# å®æ—¶æŸ¥çœ‹åç«¯æ—¥å¿—
sudo journalctl -u agentic-backend -f --lines=100

# å®æ—¶æŸ¥çœ‹å‰ç«¯æ—¥å¿—
sudo journalctl -u agentic-frontend -f --lines=100

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
tail -f /opt/agentic-ai/logs/backend-error.log
tail -f /opt/agentic-ai/logs/frontend-error.log
```

### é‡å¯æœåŠ¡

```bash
# é‡å¯åç«¯
sudo systemctl restart agentic-backend

# é‡å¯å‰ç«¯
sudo systemctl restart agentic-frontend

# é‡å¯æ‰€æœ‰æœåŠ¡
sudo systemctl restart agentic-backend agentic-frontend
```

### åœæ­¢æœåŠ¡

```bash
# åœæ­¢åç«¯
sudo systemctl stop agentic-backend

# åœæ­¢å‰ç«¯
sudo systemctl stop agentic-frontend
```

---

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: åç«¯æ— æ³•å¯åŠ¨

**æ£€æŸ¥æ­¥éª¤**ï¼š

```bash
# 1. æ£€æŸ¥ç¯å¢ƒå˜é‡
cat /opt/agentic-ai/.env | grep -v "^#" | grep -v "^$"

# 2. æ£€æŸ¥æ•°æ®åº“è¿æ¥
cd /opt/agentic-ai
source venv/bin/activate
python -c "import os; from dotenv import load_dotenv; load_dotenv(); print(os.getenv('DATABASE_URL'))"

# 3. æ‰‹åŠ¨å¯åŠ¨æŸ¥çœ‹é”™è¯¯
cd /opt/agentic-ai
source venv/bin/activate
uvicorn main:app --host 0.0.0.0 --port 8000

# 4. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
sudo journalctl -u agentic-backend -n 100 --no-pager
```

**å¸¸è§åŸå› **ï¼š
- âŒ API å¯†é’¥æœªé…ç½®æˆ–æ— æ•ˆ
- âŒ æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²é”™è¯¯
- âŒ ç«¯å£ 8000 è¢«å ç”¨
- âŒ Python ä¾èµ–æœªå®‰è£…å®Œæ•´

### é—®é¢˜ 2: å‰ç«¯æ— æ³•è®¿é—®åç«¯

**æ£€æŸ¥æ­¥éª¤**ï¼š

```bash
# 1. æ£€æŸ¥åç«¯æ˜¯å¦è¿è¡Œ
curl http://localhost:8000/health

# 2. æ£€æŸ¥ CORS é…ç½®
grep ALLOWED_ORIGINS /opt/agentic-ai/.env

# 3. æ£€æŸ¥å‰ç«¯ç¯å¢ƒå˜é‡
grep NEXT_PUBLIC_API_URL /opt/agentic-ai/ai-chatbot-main/.env.local

# 4. æµ‹è¯•ç½‘ç»œè¿æ¥
curl -v http://ä½ çš„æœåŠ¡å™¨IP:8000/health
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
- âœ… ç¡®ä¿ `.env` ä¸­çš„ `ALLOWED_ORIGINS` åŒ…å«å‰ç«¯åœ°å€
- âœ… ç¡®ä¿ `.env.local` ä¸­çš„ `NEXT_PUBLIC_API_URL` ä½¿ç”¨æ­£ç¡®çš„æœåŠ¡å™¨ IP
- âœ… æ£€æŸ¥è…¾è®¯äº‘å®‰å…¨ç»„æ˜¯å¦å¼€æ”¾ 8000 ç«¯å£

### é—®é¢˜ 3: å‰ç«¯æ„å»ºå¤±è´¥

**æ£€æŸ¥æ­¥éª¤**ï¼š

```bash
# 1. æ¸…é™¤ç¼“å­˜
cd /opt/agentic-ai/ai-chatbot-main
rm -rf .next node_modules

# 2. é‡æ–°å®‰è£…ä¾èµ–
pnpm install

# 3. æ£€æŸ¥ Node.js ç‰ˆæœ¬
node --version  # åº”è¯¥ >= 18.0.0

# 4. é‡æ–°æ„å»º
pnpm build
```

### é—®é¢˜ 4: æ•°æ®åº“è¿æ¥å¤±è´¥

**æ£€æŸ¥æ­¥éª¤**ï¼š

```bash
# 1. æµ‹è¯•æ•°æ®åº“è¿æ¥
psql "postgresql://user:password@ep-xxx.neon.tech/dbname?sslmode=require"

# 2. æ£€æŸ¥ SSL å‚æ•°
# ç¡®ä¿è¿æ¥å­—ç¬¦ä¸²åŒ…å« ?sslmode=require

# 3. æ£€æŸ¥ Neon æ•°æ®åº“çŠ¶æ€
# ç™»å½• Neon æ§åˆ¶å°æŸ¥çœ‹æ•°æ®åº“æ˜¯å¦æš‚åœï¼ˆå…è´¹ç‰ˆä¼šè‡ªåŠ¨æš‚åœï¼‰
```

### é—®é¢˜ 5: ç«¯å£è¢«å ç”¨

```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
sudo lsof -i :8000
sudo lsof -i :3000

# æ€æ­»å ç”¨è¿›ç¨‹
sudo kill -9 <PID>

# æˆ–è€…ä¿®æ”¹ç«¯å£
# ç¼–è¾‘ .env ä¿®æ”¹ PORT=8001
# ç¼–è¾‘ .env.local ä¿®æ”¹å¯¹åº”çš„ API URL
```

---

## ğŸ”’ å®‰å…¨åŠ å›ºï¼ˆå¯é€‰ï¼‰

### 1. é…ç½®é˜²ç«å¢™

```bash
# å®‰è£… ufw
sudo apt install ufw

# å…è®¸ SSH
sudo ufw allow 22/tcp

# å…è®¸å‰ç«¯
sudo ufw allow 3000/tcp

# å…è®¸åç«¯
sudo ufw allow 8000/tcp

# å¯ç”¨é˜²ç«å¢™
sudo ufw enable

# æŸ¥çœ‹çŠ¶æ€
sudo ufw status
```

### 2. é™åˆ¶ SSH è®¿é—®

```bash
# ç¼–è¾‘ SSH é…ç½®
sudo nano /etc/ssh/sshd_config

# ä¿®æ”¹ä»¥ä¸‹é…ç½®
PermitRootLogin no  # ç¦æ­¢ root ç›´æ¥ç™»å½•
PasswordAuthentication no  # ç¦ç”¨å¯†ç ç™»å½•ï¼Œä»…å…è®¸å¯†é’¥
Port 22  # æˆ–æ”¹ä¸ºå…¶ä»–ç«¯å£

# é‡å¯ SSH æœåŠ¡
sudo systemctl restart sshd
```

### 3. é…ç½® Fail2ban

```bash
# å®‰è£… Fail2ban
sudo apt install fail2ban

# å¯ç”¨æœåŠ¡
sudo systemctl enable fail2ban
sudo systemctl start fail2ban
```

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–ï¼ˆå¯é€‰ï¼‰

### 1. å¢åŠ  Uvicorn Workers

æ ¹æ®æœåŠ¡å™¨ CPU æ ¸å¿ƒæ•°è°ƒæ•´ï¼š

```bash
# ç¼–è¾‘åç«¯æœåŠ¡
sudo nano /etc/systemd/system/agentic-backend.service

# ä¿®æ”¹ workers æ•°é‡
--workers 8  # å»ºè®®è®¾ç½®ä¸º CPU æ ¸å¿ƒæ•° * 2

# é‡å¯æœåŠ¡
sudo systemctl daemon-reload
sudo systemctl restart agentic-backend
```

### 2. å¯ç”¨ PM2 ç®¡ç†å‰ç«¯ï¼ˆæ›¿ä»£ systemdï¼‰

```bash
# å®‰è£… PM2
npm install -g pm2

# å¯åŠ¨å‰ç«¯
cd /opt/agentic-ai/ai-chatbot-main
pm2 start pnpm --name "agentic-frontend" -- start

# è®¾ç½®å¼€æœºè‡ªå¯
pm2 startup
pm2 save

# æŸ¥çœ‹çŠ¶æ€
pm2 status
pm2 logs agentic-frontend
```

---

## ğŸ‰ éƒ¨ç½²å®Œæˆ

æ­å–œï¼ä½ å·²ç»æˆåŠŸåœ¨è…¾è®¯äº‘æœåŠ¡å™¨ä¸Šéƒ¨ç½²äº† AI DeepResearch Agentã€‚

**è®¿é—®åœ°å€**ï¼š
- ğŸŒ å‰ç«¯: http://ä½ çš„æœåŠ¡å™¨IP:3000
- ğŸ“¡ åç«¯ API: http://ä½ çš„æœåŠ¡å™¨IP:8000/docs

**ä¸‹ä¸€æ­¥å»ºè®®**ï¼š
1. é…ç½®åŸŸåå’Œ HTTPSï¼ˆä½¿ç”¨ Nginx + Certbotï¼‰
2. è®¾ç½®å®šæœŸå¤‡ä»½
3. é…ç½®ç›‘æ§å‘Šè­¦
4. ä¼˜åŒ–æ•°æ®åº“æ€§èƒ½

å¦‚éœ€å¸®åŠ©ï¼Œè¯·å‚è€ƒï¼š
- [GitHub Issues](https://github.com/ameureka/ai-deepresearch-agent/issues)
- [é¡¹ç›®æ–‡æ¡£](https://github.com/ameureka/ai-deepresearch-agent/tree/main/docs)

---

**éƒ¨ç½²æ•™ç¨‹ç‰ˆæœ¬**: v1.0.0  
**æœ€åæ›´æ–°**: 2025-11-03  
**é€‚ç”¨ç‰ˆæœ¬**: v3.2.0+
